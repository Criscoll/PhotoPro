{"ast":null,"code":"var _jsxFileName = \"/home/mimi/Desktop/COMP3900/capstone-project-comp3900-f11a-2mjec/photopro-app/src/pages/checkoutPage/CheckoutPage.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport \"./CheckoutPage.css\";\nimport ToolBar from \"../../components/toolbar/toolbar\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Button from \"@material-ui/core/Button\";\nimport axios from \"axios\";\nimport CheckoutItem from \"./checkoutItem/CheckoutItem\";\nimport { useHistory } from \"react-router-dom\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    \"& .MuiTextField-root\": {\n      margin: theme.spacing(1),\n      width: \"ch\"\n    }\n  }\n}));\nexport default function CheckoutPage(props) {\n  const [shoppingCartItems, setShoppingCartItems] = useState([]);\n  const [detailsValidated, setDetailsValidated] = useState(false);\n  const [errorText, setErrorText] = useState(\"\");\n  const [errorCardNum, setErrorCardNum] = useState(false);\n  const [errorName, setErrorName] = useState(false);\n  const [errorMonth, setErrorMonth] = useState(false);\n  const [errorYear, setErrorYear] = useState(false);\n  const [errorCvv, setErrorCvv] = useState(false);\n  const classes = useStyles();\n  const history = useHistory();\n\n  const getUserNotPurchasedItems = () => {\n    axios({\n      method: \"GET\",\n      url: \"http://localhost:5000/get_user_purchases\",\n      params: {\n        save_for_later: 0,\n        purchased: 0\n      }\n    }).then(response => {\n      if (response.data.result !== false) {\n        console.log(response);\n        setShoppingCartItems(response.data.result);\n      }\n    });\n  };\n\n  useEffect(() => {\n    getUserNotPurchasedItems();\n  }, []);\n\n  const updatePurchase = img_id => {\n    axios({\n      method: \"POST\",\n      url: \"http://localhost:5000/update_user_purchases_details\",\n      params: {\n        save_for_later: 0,\n        purchased: 1,\n        image_id: img_id\n      }\n    }).then(response => {\n      console.log(response); // if (response.data.result !== false) {\n      // }\n    });\n  };\n\n  const handleEditButton = () => {\n    history.push(\"/shopping-cart\");\n  };\n\n  const checkoutItemsComponents = shoppingCartItems.map(item => {\n    //console.log(item);\n    return /*#__PURE__*/React.createElement(CheckoutItem, {\n      key: item.image_id,\n      image_id: item.image_id,\n      img: item.img,\n      price: item.price,\n      title: item.title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 7\n      }\n    });\n  });\n\n  const handleCardNumberInput = event => {\n    event.stopPropagation();\n    let patt = /\\d+/;\n\n    if (event.target.value.length === 16 && patt.test(event.target.value)) {\n      setErrorCardNum(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Bank Account should be 16 digits only\");\n      setErrorCardNum(true);\n    }\n  };\n\n  const handleNameCardInput = event => {\n    event.stopPropagation();\n    let patt = /\\w+\\s\\w+/;\n\n    if (event.target.value.length > 0 && patt.test(event.target.value)) {\n      setErrorName(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Enter your card name [first name + last name]\");\n      setErrorName(true);\n    }\n  };\n\n  const handleMonthInput = event => {\n    event.stopPropagation();\n\n    if (parseInt(event.target.value) > 0 && parseInt(event.target.value) <= 12) {\n      setErrorMonth(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Input the correct month [1-12]\");\n      setErrorMonth(true);\n    }\n  };\n\n  const handleYearInput = event => {\n    event.stopPropagation();\n\n    if (parseInt(event.target.value) >= 2020) {\n      setErrorYear(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Input the correct year [2020+]\");\n      setErrorYear(true);\n    }\n  };\n\n  const handleCvvInput = event => {\n    event.stopPropagation();\n    let patt = /\\d+/;\n\n    if (parseInt(event.target.value.length) === 3 & patt.test(event.target.value)) {\n      setErrorCvv(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Input the correct CVV [3 digits]\");\n      setErrorCvv(true);\n    }\n  };\n\n  if (!errorCardNum && !errorName && !errorMonth && !errorYear && !errorYear) {\n    setDetailsValidated(true);\n  } else {\n    setDetailsValidated(false);\n  }\n\n  const handlePlaceOrderButton = () => {\n    if (detailsValidated) {\n      shoppingCartItems.map(item => {\n        console.log(item.image_id);\n        updatePurchase(item.image_id);\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ToolBar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"checkout-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 9\n    }\n  }, \"Checkout\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"checkout-grid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"payment-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 13\n    }\n  }, \"Fill payment info:\"), /*#__PURE__*/React.createElement(\"form\", {\n    className: classes.root,\n    noValidate: true,\n    autoComplete: \"off\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cart-details-grid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 17\n    }\n  }, \"CARD NUMBER\"), /*#__PURE__*/React.createElement(TextField, {\n    required: true,\n    error: errorCardNum,\n    id: \"outlined-required\",\n    label: \"Required\",\n    variant: \"outlined\",\n    helperText: errorText,\n    onSubmit: handleCardNumberInput,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 17\n    }\n  }, \"NAME ON CARD\"), /*#__PURE__*/React.createElement(TextField, {\n    required: true,\n    error: errorName,\n    helperText: errorText,\n    onSubmit: handleNameCardInput,\n    id: \"outlined-required\",\n    label: \"Required\",\n    variant: \"outlined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 17\n    }\n  }, \"EXPIRY DATE\"), /*#__PURE__*/React.createElement(TextField, {\n    required: true,\n    error: errorMonth,\n    helperText: errorText,\n    onSubmit: handleMonthInput,\n    id: \"outlined-number\",\n    label: \"Month\",\n    type: \"number\",\n    InputLabelProps: {\n      shrink: true\n    },\n    variant: \"outlined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    required: true,\n    error: errorYear,\n    helperText: errorText,\n    onChange: handleYearInput,\n    id: \"outlined-number\",\n    label: \"Year\",\n    type: \"number\",\n    InputLabelProps: {\n      shrink: true\n    },\n    variant: \"outlined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 17\n    }\n  }, \"CVV\"), /*#__PURE__*/React.createElement(TextField, {\n    required: true,\n    error: errorCvv,\n    helperText: errorText,\n    onChange: handleCvvInput,\n    id: \"outlined-required\",\n    label: \"Required\",\n    defaultValue: \"123\",\n    variant: \"outlined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    size: \"large\",\n    onClick: handlePlaceOrderButton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 17\n    }\n  }, \"PLACE ORDER\"), /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 17\n    }\n  }, !detailsValidated ? \"INPUT THE CORRECT DETAILS\" : null)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"purchase-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 13\n    }\n  }, shoppingCartItems.length, \" \", shoppingCartItems.length > 1 ? \"Items\" : \"Item\", \":\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    onClick: handleEditButton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 13\n    }\n  }, \"Edit\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"purchased-items\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 13\n    }\n  }, checkoutItemsComponents), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 13\n    }\n  }, \"TOTAL TO PAY: $\", props.location.state.totalPrice)))));\n}","map":{"version":3,"sources":["/home/mimi/Desktop/COMP3900/capstone-project-comp3900-f11a-2mjec/photopro-app/src/pages/checkoutPage/CheckoutPage.jsx"],"names":["React","useState","useEffect","ToolBar","TextField","Button","axios","CheckoutItem","useHistory","makeStyles","useStyles","theme","root","margin","spacing","width","CheckoutPage","props","shoppingCartItems","setShoppingCartItems","detailsValidated","setDetailsValidated","errorText","setErrorText","errorCardNum","setErrorCardNum","errorName","setErrorName","errorMonth","setErrorMonth","errorYear","setErrorYear","errorCvv","setErrorCvv","classes","history","getUserNotPurchasedItems","method","url","params","save_for_later","purchased","then","response","data","result","console","log","updatePurchase","img_id","image_id","handleEditButton","push","checkoutItemsComponents","map","item","img","price","title","handleCardNumberInput","event","stopPropagation","patt","target","value","length","test","handleNameCardInput","handleMonthInput","parseInt","handleYearInput","handleCvvInput","handlePlaceOrderButton","shrink","location","state","totalPrice"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./CheckoutPage.css\";\nimport ToolBar from \"../../components/toolbar/toolbar\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Button from \"@material-ui/core/Button\";\nimport axios from \"axios\";\nimport CheckoutItem from \"./checkoutItem/CheckoutItem\";\nimport { useHistory } from \"react-router-dom\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    \"& .MuiTextField-root\": {\n      margin: theme.spacing(1),\n      width: \"ch\",\n    },\n  },\n}));\n\nexport default function CheckoutPage(props) {\n  const [shoppingCartItems, setShoppingCartItems] = useState([]);\n  const [detailsValidated, setDetailsValidated] = useState(false);\n\n  const [errorText, setErrorText] = useState(\"\");\n  const [errorCardNum, setErrorCardNum] = useState(false);\n  const [errorName, setErrorName] = useState(false);\n  const [errorMonth, setErrorMonth] = useState(false);\n  const [errorYear, setErrorYear] = useState(false);\n  const [errorCvv, setErrorCvv] = useState(false);\n\n  const classes = useStyles();\n\n  const history = useHistory();\n\n  const getUserNotPurchasedItems = () => {\n    axios({\n      method: \"GET\",\n      url: \"http://localhost:5000/get_user_purchases\",\n      params: {\n        save_for_later: 0,\n        purchased: 0,\n      },\n    }).then((response) => {\n      if (response.data.result !== false) {\n        console.log(response);\n        setShoppingCartItems(response.data.result);\n      }\n    });\n  };\n\n  useEffect(() => {\n    getUserNotPurchasedItems();\n  }, []);\n\n  const updatePurchase = (img_id) => {\n    axios({\n      method: \"POST\",\n      url: \"http://localhost:5000/update_user_purchases_details\",\n      params: {\n        save_for_later: 0,\n        purchased: 1,\n        image_id: img_id,\n      },\n    }).then((response) => {\n      console.log(response);\n      // if (response.data.result !== false) {\n      // }\n    });\n  };\n\n  const handleEditButton = () => {\n    history.push(\"/shopping-cart\");\n  };\n\n  const checkoutItemsComponents = shoppingCartItems.map((item) => {\n    //console.log(item);\n    return (\n      <CheckoutItem\n        key={item.image_id}\n        image_id={item.image_id}\n        img={item.img}\n        price={item.price}\n        title={item.title}\n      />\n    );\n  });\n\n  const handleCardNumberInput = (event) => {\n    event.stopPropagation();\n    let patt = /\\d+/;\n    if (event.target.value.length === 16 && patt.test(event.target.value)) {\n      setErrorCardNum(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Bank Account should be 16 digits only\");\n      setErrorCardNum(true);\n    }\n  };\n\n  const handleNameCardInput = (event) => {\n    event.stopPropagation();\n    let patt = /\\w+\\s\\w+/;\n    if (event.target.value.length > 0 && patt.test(event.target.value)) {\n      setErrorName(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Enter your card name [first name + last name]\");\n      setErrorName(true);\n    }\n  };\n\n  const handleMonthInput = (event) => {\n    event.stopPropagation();\n    if (\n      parseInt(event.target.value) > 0 &&\n      parseInt(event.target.value) <= 12\n    ) {\n      setErrorMonth(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Input the correct month [1-12]\");\n      setErrorMonth(true);\n    }\n  };\n\n  const handleYearInput = (event) => {\n    event.stopPropagation();\n    if (parseInt(event.target.value) >= 2020) {\n      setErrorYear(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Input the correct year [2020+]\");\n      setErrorYear(true);\n    }\n  };\n\n  const handleCvvInput = (event) => {\n    event.stopPropagation();\n    let patt = /\\d+/;\n    if (\n      (parseInt(event.target.value.length) === 3) &\n      patt.test(event.target.value)\n    ) {\n      setErrorCvv(false);\n      setErrorText(\"\");\n    } else {\n      setErrorText(\"Input the correct CVV [3 digits]\");\n      setErrorCvv(true);\n    }\n  };\n\n  if (!errorCardNum && !errorName && !errorMonth && !errorYear && !errorYear) {\n    setDetailsValidated(true);\n  } else {\n    setDetailsValidated(false);\n  }\n\n  const handlePlaceOrderButton = () => {\n    if (detailsValidated) {\n      shoppingCartItems.map((item) => {\n        console.log(item.image_id);\n\n        updatePurchase(item.image_id);\n      });\n    }\n  };\n\n  return (\n    <React.Fragment>\n      <ToolBar />\n      <div className=\"checkout-wrapper\">\n        <h1>Checkout</h1>\n        <div className=\"checkout-grid\">\n          <div className=\"payment-info\">\n            <h2>Fill payment info:</h2>\n            <form className={classes.root} noValidate autoComplete=\"off\">\n              <div className=\"cart-details-grid\">\n                <h3>CARD NUMBER</h3>\n                <TextField\n                  required\n                  error={errorCardNum}\n                  id=\"outlined-required\"\n                  label=\"Required\"\n                  variant=\"outlined\"\n                  helperText={errorText}\n                  onSubmit={handleCardNumberInput}\n                />\n                <h3>NAME ON CARD</h3>\n                <TextField\n                  required\n                  error={errorName}\n                  helperText={errorText}\n                  onSubmit={handleNameCardInput}\n                  id=\"outlined-required\"\n                  label=\"Required\"\n                  variant=\"outlined\"\n                />\n                <h3>EXPIRY DATE</h3>\n                <TextField\n                  required\n                  error={errorMonth}\n                  helperText={errorText}\n                  onSubmit={handleMonthInput}\n                  id=\"outlined-number\"\n                  label=\"Month\"\n                  type=\"number\"\n                  InputLabelProps={{\n                    shrink: true,\n                  }}\n                  variant=\"outlined\"\n                />\n                <TextField\n                  required\n                  error={errorYear}\n                  helperText={errorText}\n                  onChange={handleYearInput}\n                  id=\"outlined-number\"\n                  label=\"Year\"\n                  type=\"number\"\n                  InputLabelProps={{\n                    shrink: true,\n                  }}\n                  variant=\"outlined\"\n                />\n                <h3>CVV</h3>\n                <TextField\n                  required\n                  error={errorCvv}\n                  helperText={errorText}\n                  onChange={handleCvvInput}\n                  id=\"outlined-required\"\n                  label=\"Required\"\n                  defaultValue=\"123\"\n                  variant=\"outlined\"\n                />\n                <Button\n                  variant=\"contained\"\n                  color=\"primary\"\n                  size=\"large\"\n                  onClick={handlePlaceOrderButton}\n                >\n                  PLACE ORDER\n                </Button>\n                <h1>\n                  {!detailsValidated ? \"INPUT THE CORRECT DETAILS\" : null}\n                </h1>\n              </div>\n            </form>\n          </div>\n          <div className=\"purchase-info\">\n            <h2>\n              {shoppingCartItems.length}{\" \"}\n              {shoppingCartItems.length > 1 ? \"Items\" : \"Item\"}:\n            </h2>\n            <Button color=\"primary\" onClick={handleEditButton}>\n              Edit\n            </Button>\n            <div className=\"purchased-items\">{checkoutItemsComponents}</div>\n            <h2>TOTAL TO PAY: ${props.location.state.totalPrice}</h2>\n          </div>\n        </div>\n      </div>\n    </React.Fragment>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}